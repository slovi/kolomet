<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/security
	http://www.springframework.org/schema/security/spring-security.xsd">

	<http auto-config="true">
		<intercept-url pattern="/public/*" access="ROLE_ANONYMOUS" />
		<intercept-url pattern="/applicationusers*" access="ROLE_per_applicationusers" />
		<intercept-url pattern="/applicationusers/*" access="ROLE_per_applicationusers" />
		<intercept-url pattern="/applicationpermissions*" access="ROLE_per_applicationpermissions" />
		<intercept-url pattern="/applicationpermissions/*" access="ROLE_per_applicationpermissions" />
		<intercept-url pattern="/applicationroles*" access="ROLE_per_applicationroles" />
		<intercept-url pattern="/applicationroles/*" access="ROLE_per_applicationroles" />
		<intercept-url pattern="/sellers*" access="ROLE_per_sellers" />
		<intercept-url pattern="/sellers/*" access="ROLE_per_sellers" />
		<intercept-url pattern="/sellerstatuses*" access="ROLE_per_sellerstatuses" />
		<intercept-url pattern="/sellerstatuses/*" access="ROLE_per_sellerstatuses" />
		<intercept-url pattern="/sellerphotourls*" access="ROLE_per_sellerphotourls" />
		<intercept-url pattern="/sellerphotourls/*" access="ROLE_per_sellerphotourls" />
		<intercept-url pattern="/regions*" access="ROLE_per_regions" />
		<intercept-url pattern="/regions/*" access="ROLE_per_regions" />
		<intercept-url pattern="/countrystates*" access="ROLE_per_countrystates" />
		<intercept-url pattern="/countrystates/*" access="ROLE_per_countrystates" />
		<intercept-url pattern="/region*" access="ROLE_per_regions" />
		<intercept-url pattern="/region/*" access="ROLE_per_regions" />
		<intercept-url pattern="/products*" access="ROLE_per_products" />
		<intercept-url pattern="/products/*" access="ROLE_per_products" />
		<intercept-url pattern="/photourls*" access="ROLE_per_photourls" />
		<intercept-url pattern="/photourls/*" access="ROLE_per_photourls" />
		<intercept-url pattern="/productattributes*" access="ROLE_per_productattributes" />
		<intercept-url pattern="/productattributes/*" access="ROLE_per_productattributes" />
		<intercept-url pattern="/productattributetypes*" access="ROLE_per_productattributetypes" />
		<intercept-url pattern="/productattributetypes/*" access="ROLE_per_productattributetypes" />
		<intercept-url pattern="/producers*" access="ROLE_per_producers" />
		<intercept-url pattern="/producers/*" access="ROLE_per_producers" />
		<intercept-url pattern="/categorys*" access="ROLE_per_categorys" />
		<intercept-url pattern="/categorys/*" access="ROLE_per_categorys" />
		<intercept-url pattern="/categorytypes*" access="ROLE_per_categorytypes" />
		<intercept-url pattern="/categorytypes/*" access="ROLE_per_categorytypes" />
		<intercept-url pattern="/newsitems" access="ROLE_per_newsitems" />
		<intercept-url pattern="/newsitems/*" access="ROLE_per_newsitems" />
		<form-login login-page="/public/intro/index?showloginform" authentication-failure-handler-ref="authenticationFailureHandler" authentication-success-handler-ref="authenticationSuccessHandler" />
	</http>

	<authentication-manager>
		<authentication-provider user-service-ref="dbUserService" />
	</authentication-manager>
	
	<beans:bean id="dbUserService" class="cz.kolomet.security.ApplicationUserDetailsService" />
	<beans:bean id="authenticationFailureHandler" class="cz.kolomet.security.KolometAuthenticationFailureHandler" />
	<beans:bean id="authenticationSuccessHandler" class="cz.kolomet.security.KolometAuthenticationSuccessHandler" />		

</beans:beans>